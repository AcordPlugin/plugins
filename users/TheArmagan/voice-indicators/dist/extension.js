(function(lt,ht,m,ft,ut,dt,pt,mt,gt,yt){"use strict";function O(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}function vt(n){if(n&&n.__esModule)return n;var e=Object.create(null);return n&&Object.keys(n).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return n[t]}})}}),e.default=n,Object.freeze(e)}var D=O(lt),me=O(ht),ee=O(ft),ge=O(ut),Y=O(dt),d=vt(pt),te=O(mt),ye=O(gt);const C=Object.create(null);C.open="0",C.close="1",C.ping="2",C.pong="3",C.message="4",C.upgrade="5",C.noop="6";const Z=Object.create(null);Object.keys(C).forEach(n=>{Z[C[n]]=n});const bt={type:"error",data:"parser error"},xt=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ct=typeof ArrayBuffer=="function",wt=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,ve=({type:n,data:e},t,r)=>xt&&e instanceof Blob?t?r(e):be(e,r):Ct&&(e instanceof ArrayBuffer||wt(e))?t?r(e):be(new Blob([e]),r):r(C[n]+(e||"")),be=(n,e)=>{const t=new FileReader;return t.onload=function(){const r=t.result.split(",")[1];e("b"+r)},t.readAsDataURL(n)},xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<xe.length;n++)M[xe.charCodeAt(n)]=n;const Et=n=>{let e=n.length*.75,t=n.length,r,i=0,s,o,a,c;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const u=new ArrayBuffer(e),h=new Uint8Array(u);for(r=0;r<t;r+=4)s=M[n.charCodeAt(r)],o=M[n.charCodeAt(r+1)],a=M[n.charCodeAt(r+2)],c=M[n.charCodeAt(r+3)],h[i++]=s<<2|o>>4,h[i++]=(o&15)<<4|a>>2,h[i++]=(a&3)<<6|c&63;return u},kt=typeof ArrayBuffer=="function",Ce=(n,e)=>{if(typeof n!="string")return{type:"message",data:we(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:Nt(n.substring(1),e)}:Z[t]?n.length>1?{type:Z[t],data:n.substring(1)}:{type:Z[t]}:bt},Nt=(n,e)=>{if(kt){const t=Et(n);return we(t,e)}else return{base64:!0,data:n}},we=(n,e)=>{switch(e){case"blob":return n instanceof ArrayBuffer?new Blob([n]):n;case"arraybuffer":default:return n}},Ee=String.fromCharCode(30),At=(n,e)=>{const t=n.length,r=new Array(t);let i=0;n.forEach((s,o)=>{ve(s,!1,a=>{r[o]=a,++i===t&&e(r.join(Ee))})})},_t=(n,e)=>{const t=n.split(Ee),r=[];for(let i=0;i<t.length;i++){const s=Ce(t[i],e);if(r.push(s),s.type==="error")break}return r},ke=4;function p(n){if(n)return Tt(n)}function Tt(n){for(var e in p.prototype)n[e]=p.prototype[e];return n}p.prototype.on=p.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this},p.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this},p.prototype.off=p.prototype.removeListener=p.prototype.removeAllListeners=p.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var r,i=0;i<t.length;i++)if(r=t[i],r===e||r.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+n],this},p.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,i=t.length;r<i;++r)t[r].apply(this,e)}return this},p.prototype.emitReserved=p.prototype.emit,p.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]},p.prototype.hasListeners=function(n){return!!this.listeners(n).length};const T=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function Ne(n,...e){return e.reduce((t,r)=>(n.hasOwnProperty(r)&&(t[r]=n[r]),t),{})}const Rt=setTimeout,Ot=clearTimeout;function K(n,e){e.useNativeTimers?(n.setTimeoutFn=Rt.bind(T),n.clearTimeoutFn=Ot.bind(T)):(n.setTimeoutFn=setTimeout.bind(T),n.clearTimeoutFn=clearTimeout.bind(T))}const St=1.33;function It(n){return typeof n=="string"?Lt(n):Math.ceil((n.byteLength||n.size)*St)}function Lt(n){let e=0,t=0;for(let r=0,i=n.length;r<i;r++)e=n.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}class Bt extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class Ae extends p{constructor(e){super(),this.writable=!1,K(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new Bt(e,t,r)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Ce(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}}const _e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),ne=64,Vt={};let Te=0,W=0,Re;function Oe(n){let e="";do e=_e[n%ne]+e,n=Math.floor(n/ne);while(n>0);return e}function Se(){const n=Oe(+new Date);return n!==Re?(Te=0,Re=n):n+"."+Oe(Te++)}for(;W<ne;W++)Vt[_e[W]]=W;function Ie(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function Dt(n){let e={},t=n.split("&");for(let r=0,i=t.length;r<i;r++){let s=t[r].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}let Le=!1;try{Le=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Mt=Le;function Be(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Mt))return new XMLHttpRequest}catch{}if(!e)try{return new T[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function Pt(){}const $t=function(){return new Be({xdomain:!1}).responseType!=null}();class Ut extends Ae{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const r=location.protocol==="https:";let i=location.port;i||(i=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port,this.xs=e.secure!==r}const t=e&&e.forceBase64;this.supportsBinary=$t&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};_t(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,At(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let r="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Se()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port);const i=Ie(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(i.length?"?"+i:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new w(this.uri(),e)}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}}class w extends p{constructor(e,t){super(),K(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){const e=Ne(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new Be(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let r in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.opts.extraHeaders[r])}}catch{}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{t.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},t.send(this.data)}catch(r){this.setTimeoutFn(()=>{this.onError(r)},0);return}typeof document<"u"&&(this.index=w.requestsCount++,w.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=Pt,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete w.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(w.requestsCount=0,w.requests={},typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ve);else if(typeof addEventListener=="function"){const n="onpagehide"in T?"pagehide":"unload";addEventListener(n,Ve,!1)}}function Ve(){for(let n in w.requests)w.requests.hasOwnProperty(n)&&w.requests[n].abort()}const qt=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))(),J=T.WebSocket||T.MozWebSocket,De=!0,Ht="arraybuffer",Me=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class zt extends Ae{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,r=Me?{}:Ne(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=De&&!Me?t?new J(e,t):new J(e):new J(e,t,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType||Ht,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],i=t===e.length-1;ve(r,this.supportsBinary,s=>{const o={};try{De&&this.ws.send(s)}catch{}i&&qt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let r="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=Se()),this.supportsBinary||(e.b64=1);const i=Ie(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(i.length?"?"+i:"")}check(){return!!J}}const jt={websocket:zt,polling:Ut},Ft=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Yt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function re(n){const e=n,t=n.indexOf("["),r=n.indexOf("]");t!=-1&&r!=-1&&(n=n.substring(0,t)+n.substring(t,r).replace(/:/g,";")+n.substring(r,n.length));let i=Ft.exec(n||""),s={},o=14;for(;o--;)s[Yt[o]]=i[o]||"";return t!=-1&&r!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=Zt(s,s.path),s.queryKey=Kt(s,s.query),s}function Zt(n,e){const t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&r.splice(0,1),e.substr(e.length-1,1)=="/"&&r.splice(r.length-1,1),r}function Kt(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,s){i&&(t[i]=s)}),t}class R extends p{constructor(e,t={}){super(),e&&typeof e=="object"&&(t=e,e=null),e?(e=re(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=re(t.host).host),K(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=Dt(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=ke,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new jt[e](r)}open(){let e;if(this.opts.rememberUpgrade&&R.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(e){let t=this.createTransport(e),r=!1;R.priorWebsocketSuccess=!1;const i=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",v=>{if(!r)if(v.type==="pong"&&v.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;R.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(h(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const N=new Error("probe error");N.transport=t.name,this.emitReserved("upgradeError",N)}}))};function s(){r||(r=!0,h(),t.close(),t=null)}const o=v=>{const N=new Error("probe error: "+v);N.transport=t.name,s(),this.emitReserved("upgradeError",N)};function a(){o("transport closed")}function c(){o("socket closed")}function u(v){t&&v.name!==t.name&&s()}const h=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",a),this.off("close",c),this.off("upgrading",u)};t.once("open",i),t.once("error",o),t.once("close",a),this.once("close",c),this.once("upgrading",u),t.open()}onOpen(){if(this.readyState="open",R.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(t+=It(i)),r>0&&t>this.maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,i){if(typeof t=="function"&&(i=t,t=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const s={type:e,data:t,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}onError(e){R.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let r=0;const i=e.length;for(;r<i;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}R.protocol=ke;function Wt(n,e="",t){let r=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),r=re(n)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port+e,r.href=r.protocol+"://"+s+(t&&t.port===r.port?"":":"+r.port),r}const Jt=typeof ArrayBuffer=="function",Xt=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,Pe=Object.prototype.toString,Gt=typeof Blob=="function"||typeof Blob<"u"&&Pe.call(Blob)==="[object BlobConstructor]",Qt=typeof File=="function"||typeof File<"u"&&Pe.call(File)==="[object FileConstructor]";function se(n){return Jt&&(n instanceof ArrayBuffer||Xt(n))||Gt&&n instanceof Blob||Qt&&n instanceof File}function X(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(X(n[t]))return!0;return!1}if(se(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return X(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&X(n[t]))return!0;return!1}function en(n){const e=[],t=n.data,r=n;return r.data=ie(t,e),r.attachments=e.length,{packet:r,buffers:e}}function ie(n,e){if(!n)return n;if(se(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let r=0;r<n.length;r++)t[r]=ie(n[r],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=ie(n[r],e));return t}return n}function tn(n,e){return n.data=oe(n.data,e),n.attachments=void 0,n}function oe(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=oe(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=oe(n[t],e));return n}const nn=5;var f;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(f||(f={}));class rn{constructor(e){this.replacer=e}encode(e){return(e.type===f.EVENT||e.type===f.ACK)&&X(e)?(e.type=e.type===f.EVENT?f.BINARY_EVENT:f.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===f.BINARY_EVENT||e.type===f.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=en(e),r=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(r),i}}class ae extends p{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e),t.type===f.BINARY_EVENT||t.type===f.BINARY_ACK?(this.reconstructor=new sn(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(se(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(f[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===f.BINARY_EVENT||r.type===f.BINARY_ACK){const s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(t+1)==="/"){const s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(s,t)}else r.nsp="/";const i=e.charAt(t+1);if(i!==""&&Number(i)==i){const s=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}r.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if(ae.isPayloadValid(r.type,s))r.data=s;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case f.CONNECT:return typeof t=="object";case f.DISCONNECT:return t===void 0;case f.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case f.EVENT:case f.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case f.ACK:case f.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class sn{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=tn(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var on=Object.freeze({__proto__:null,protocol:nn,get PacketType(){return f},Encoder:rn,Decoder:ae});function x(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const an=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class $e extends p{constructor(e,t,r){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[x(e,"open",this.onopen.bind(this)),x(e,"packet",this.onpacket.bind(this)),x(e,"error",this.onerror.bind(this)),x(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(an.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');t.unshift(e);const r={type:f.EVENT,data:t};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const o=this.ids++,a=t.pop();this._registerAckCallback(o,a),r.id=o}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){const r=this.flags.timeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&this.sendBuffer.splice(s,1);t.call(this,new Error("operation has timed out"))},r);this.acks[e]=(...s)=>{this.io.clearTimeoutFn(i),t.apply(this,[null,...s])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this.packet({type:f.CONNECT,data:e})}):this.packet({type:f.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case f.CONNECT:if(e.data&&e.data.sid){const i=e.data.sid;this.onconnect(i)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case f.EVENT:case f.BINARY_EVENT:this.onevent(e);break;case f.ACK:case f.BINARY_ACK:this.onack(e);break;case f.DISCONNECT:this.ondisconnect();break;case f.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e)}ack(e){const t=this;let r=!1;return function(...i){r||(r=!0,t.packet({type:f.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:f.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function I(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}I.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=(Math.floor(e*10)&1)==0?n-t:n+t}return Math.min(n,this.max)|0},I.prototype.reset=function(){this.attempts=0},I.prototype.setMin=function(n){this.ms=n},I.prototype.setMax=function(n){this.max=n},I.prototype.setJitter=function(n){this.jitter=n};class ce extends p{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,K(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new I({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||on;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new R(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=x(t,"open",function(){r.onopen(),e&&e()}),s=x(t,"error",o=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",o),e?e(o):r.maybeReconnectOnOpen()});if(this._timeout!==!1){const o=this._timeout;o===0&&i();const a=this.setTimeoutFn(()=>{i(),t.close(),t.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(i),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(x(e,"ping",this.onping.bind(this)),x(e,"data",this.ondata.bind(this)),x(e,"error",this.onerror.bind(this)),x(e,"close",this.onclose.bind(this)),x(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch{this.onclose("parse error")}}ondecoded(e){this.emitReserved("packet",e)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r||(r=new $e(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t)if(this.nsps[r].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const P={};function G(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=Wt(n,e.path||"/socket.io"),r=t.source,i=t.id,s=t.path,o=P[i]&&s in P[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return a?c=new ce(r,e):(P[i]||(P[i]=new ce(r,e)),c=P[i]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Object.assign(G,{Manager:ce,Socket:$e,io:G,connect:G});const{PermissionStore:Ue,VoiceStateStore:le,ChannelStore:he,GuildStore:cn,UserStore:$,InviteActions:ln,FluxDispatcher:gr,Router:{transitionTo:hn},React:l,modals:{actions:{show:fn},ModalRoot:un}}=me.default,{Permissions:qe}=me.default.constants,{selectVoiceChannel:dn}=D.default.findByProps("selectVoiceChannel","disconnect");function pn(n){return Object.values(le.getAllVoiceStates()).map(e=>Object.values(e)).flat().map(e=>[e.userId,fe(e.userId,n)]).filter(e=>e[1]?.length)}function He(n){let e=le.getVoiceStatesForChannel(n);return e?Object.keys(e).map(t=>Q(fe(t))).filter(t=>t?.id):[]}function fe(n,e){return Object.values(le.__getLocalVars().users[n]||{}).map(t=>e?ze(t).join(";"):ze(t))}function ze(n){let e=m.persist.ghost.settings?.redacted??!1,t=he.getChannel(n.channelId),r=cn.getGuild(t?.guild_id),i=$.getUser(n.userId);return[n.selfDeaf||n.deaf?`${n.deaf?"guildDeaf":"deaf"}`:n.selfMute||n.mute||n.suppress?`${n.mute?"guildMute":"mute"}`:n.selfVideo?"video":n.selfStream?"stream":"normal",i.id,i.tag,i.avatar||"",n.channelId||"",t?e?"Unknown":t.name||[...new Map([...t.recipients.map(s=>[s,$.getUser(s)]),[$.getCurrentUser().id,$.getCurrentUser()]]).values()].filter(s=>s).map(s=>s.username).sort((s,o)=>s>o).join(", ")||"Unknown":"",t?e?"":t?.icon||"":"",t&&e||"",r?r.id:"",r?r.name:"",r&&r?.vanityURLCode||"",r&&r?.icon||""].map(s=>`${s}`.replaceAll(";",""))}function Q(n){return typeof n=="string"&&(n=n.split(";")),{state:n[0],userId:n[1],userTag:n[2],userAvatar:n[3],channelId:n[4],channelName:n[5],channelIcon:n[6],channelRedacted:n[7]=="true",guildId:n[8],guildName:n[9],guildVanity:n[10],guildIcon:n[11]}}var U={},ue={};const de=32;function mn(n,e,t){let r=0;for(let i=0,s=t.length;i<s;i++)r=t.charCodeAt(i),r<128?n[e++]=r:r<2048?(n[e++]=192|r>>6,n[e++]=128|r&63):r<55296||r>=57344?(n[e++]=224|r>>12,n[e++]=128|r>>6&63,n[e++]=128|r&63):(i++,r=65536+((r&1023)<<10|t.charCodeAt(i)&1023),n[e++]=240|r>>18,n[e++]=128|r>>12&63,n[e++]=128|r>>6&63,n[e++]=128|r&63)}function gn(n){let e=0,t=0;for(let r=0,i=n.length;r<i;r++)e=n.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}function q(n,e,t){let r=0,i=0,s=0,o=0;switch(typeof t){case"string":if(t.length>de?s=Buffer.byteLength(t):s=gn(t),s<32)n.push(s|160),o=1;else if(s<256)n.push(217,s),o=2;else if(s<65536)n.push(218,s>>8,s),o=3;else if(s<4294967296)n.push(219,s>>24,s>>16,s>>8,s),o=5;else throw new Error("String too long");return e.push({str:t,length:s,offset:n.length}),o+s;case"number":return Math.floor(t)!==t||!isFinite(t)?(n.push(203),e.push({float:t,length:8,offset:n.length}),9):t>=0?t<128?(n.push(t),1):t<256?(n.push(204,t),2):t<65536?(n.push(205,t>>8,t),3):t<4294967296?(n.push(206,t>>24,t>>16,t>>8,t),5):(r=t/Math.pow(2,32)>>0,i=t>>>0,n.push(207,r>>24,r>>16,r>>8,r,i>>24,i>>16,i>>8,i),9):t>=-32?(n.push(t),1):t>=-128?(n.push(208,t),2):t>=-32768?(n.push(209,t>>8,t),3):t>=-2147483648?(n.push(210,t>>24,t>>16,t>>8,t),5):(r=Math.floor(t/Math.pow(2,32)),i=t>>>0,n.push(211,r>>24,r>>16,r>>8,r,i>>24,i>>16,i>>8,i),9);case"object":if(t===null)return n.push(192),1;if(Array.isArray(t)){if(s=t.length,s<16)n.push(s|144),o=1;else if(s<65536)n.push(220,s>>8,s),o=3;else if(s<4294967296)n.push(221,s>>24,s>>16,s>>8,s),o=5;else throw new Error("Array too large");for(let h=0;h<s;h++)o+=q(n,e,t[h]);return o}if(t instanceof Date){const h=t.getTime();return r=Math.floor(h/Math.pow(2,32)),i=h>>>0,n.push(215,0,r>>24,r>>16,r>>8,r,i>>24,i>>16,i>>8,i),10}if(t instanceof Buffer){if(s=t.length,s<256)n.push(196,s),o=2;else if(s<65536)n.push(197,s>>8,s),o=3;else if(s<4294967296)n.push(198,s>>24,s>>16,s>>8,s),o=5;else throw new Error("Buffer too large");return e.push({bin:t,length:s,offset:n.length}),o+s}if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)){const h=t.buffer||t;if(s=h.byteLength,s<256)n.push(199,s,0),o=3;else if(s<65536)n.push(200,s>>8,s,0),o=4;else if(s<4294967296)n.push(201,s>>24,s>>16,s>>8,s,0),o=6;else throw new Error("ArrayBuffer too large");return e.push({arraybuffer:h,length:s,offset:n.length}),o+s}if(typeof t.toJSON=="function")return q(n,e,t.toJSON());const a=[],c=Object.keys(t);let u="";for(let h=0,v=c.length;h<v;h++)u=c[h],typeof t[u]!="function"&&a.push(u);if(s=a.length,s<16)n.push(s|128),o=1;else if(s<65536)n.push(222,s>>8,s),o=3;else if(s<4294967296)n.push(223,s>>24,s>>16,s>>8,s),o=5;else throw new Error("Object too large");for(let h=0;h<s;h++)u=a[h],o+=q(n,e,u),o+=q(n,e,t[u]);return o;case"boolean":return n.push(t?195:194),1;case"undefined":return n.push(212,0,0),3;default:throw new Error("Could not encode")}}function yn(n){const e=[],t=[],r=q(e,t,n),i=Buffer.allocUnsafe(r);let s=0,o=0,a=-1;t.length>0&&(a=t[0].offset);let c,u=0,h=0;for(let v=0,N=e.length;v<N;v++)if(i[o+v]=e[v],v+1===a){if(c=t[s],u=c.length,h=o+a,c.bin)if(u>de)c.bin.copy(i,h,0,u);else{const pe=c.bin;for(let A=0;A<u;A++)i[h+A]=pe[A]}else if(c.str)u>de?i.write(c.str,h,u,"utf8"):mn(i,h,c.str);else if(c.float!==void 0)i.writeDoubleBE(c.float,h);else if(c.arraybuffer){const pe=new Uint8Array(c.arraybuffer);for(let A=0;A<u;A++)i[h+A]=pe[A]}s++,o+=u,t[s]&&(a=t[s].offset)}return i}var vn=yn;function S(n){this.offset=0,this.buffer=n}S.prototype.array=function(n){const e=new Array(n);for(let t=0;t<n;t++)e[t]=this.parse();return e},S.prototype.map=function(n){let e="",t={};for(let r=0;r<n;r++)e=this.parse(),t[e]=this.parse();return t},S.prototype.str=function(n){const e=this.buffer.toString("utf8",this.offset,this.offset+n);return this.offset+=n,e},S.prototype.bin=function(n){const e=this.buffer.slice(this.offset,this.offset+n);return this.offset+=n,e},S.prototype.arraybuffer=function(n){const e=new ArrayBuffer(n),t=new Uint8Array(e);for(let r=0;r<n;r++)t[r]=this.buffer[this.offset+r];return this.offset+=n,e},S.prototype.parse=function(){const n=this.buffer[this.offset++];let e,t=0,r=0,i=0,s=0;if(n<192)return n<128?n:n<144?this.map(n&15):n<160?this.array(n&15):this.str(n&31);if(n>223)return(255-n+1)*-1;switch(n){case 192:return null;case 194:return!1;case 195:return!0;case 196:return t=this.buffer.readUInt8(this.offset),this.offset+=1,this.bin(t);case 197:return t=this.buffer.readUInt16BE(this.offset),this.offset+=2,this.bin(t);case 198:return t=this.buffer.readUInt32BE(this.offset),this.offset+=4,this.bin(t);case 199:return t=this.buffer.readUInt8(this.offset),r=this.buffer.readInt8(this.offset+1),this.offset+=2,r===0?this.arraybuffer(t):[r,this.bin(t)];case 200:return t=this.buffer.readUInt16BE(this.offset),r=this.buffer.readInt8(this.offset+2),this.offset+=3,r===0?this.arraybuffer(t):[r,this.bin(t)];case 201:return t=this.buffer.readUInt32BE(this.offset),r=this.buffer.readInt8(this.offset+4),this.offset+=5,r===0?this.arraybuffer(t):[r,this.bin(t)];case 202:return e=this.buffer.readFloatBE(this.offset),this.offset+=4,e;case 203:return e=this.buffer.readDoubleBE(this.offset),this.offset+=8,e;case 204:return e=this.buffer.readUInt8(this.offset),this.offset+=1,e;case 205:return e=this.buffer.readUInt16BE(this.offset),this.offset+=2,e;case 206:return e=this.buffer.readUInt32BE(this.offset),this.offset+=4,e;case 207:return i=this.buffer.readUInt32BE(this.offset)*Math.pow(2,32),s=this.buffer.readUInt32BE(this.offset+4),this.offset+=8,i+s;case 208:return e=this.buffer.readInt8(this.offset),this.offset+=1,e;case 209:return e=this.buffer.readInt16BE(this.offset),this.offset+=2,e;case 210:return e=this.buffer.readInt32BE(this.offset),this.offset+=4,e;case 211:return i=this.buffer.readInt32BE(this.offset)*Math.pow(2,32),s=this.buffer.readUInt32BE(this.offset+4),this.offset+=8,i+s;case 212:if(r=this.buffer.readInt8(this.offset),this.offset+=1,r===0){this.offset+=1;return}return[r,this.bin(1)];case 213:return r=this.buffer.readInt8(this.offset),this.offset+=1,[r,this.bin(2)];case 214:return r=this.buffer.readInt8(this.offset),this.offset+=1,[r,this.bin(4)];case 215:return r=this.buffer.readInt8(this.offset),this.offset+=1,r===0?(i=this.buffer.readInt32BE(this.offset)*Math.pow(2,32),s=this.buffer.readUInt32BE(this.offset+4),this.offset+=8,new Date(i+s)):[r,this.bin(8)];case 216:return r=this.buffer.readInt8(this.offset),this.offset+=1,[r,this.bin(16)];case 217:return t=this.buffer.readUInt8(this.offset),this.offset+=1,this.str(t);case 218:return t=this.buffer.readUInt16BE(this.offset),this.offset+=2,this.str(t);case 219:return t=this.buffer.readUInt32BE(this.offset),this.offset+=4,this.str(t);case 220:return t=this.buffer.readUInt16BE(this.offset),this.offset+=2,this.array(t);case 221:return t=this.buffer.readUInt32BE(this.offset),this.offset+=4,this.array(t);case 222:return t=this.buffer.readUInt16BE(this.offset),this.offset+=2,this.map(t);case 223:return t=this.buffer.readUInt32BE(this.offset),this.offset+=4,this.map(t)}throw new Error("Could not parse")};function bn(n){const e=new S(n),t=e.parse();if(e.offset!==n.length)throw new Error(n.length-e.offset+" trailing bytes");return t}var xn=bn;ue.encode=vn,ue.decode=xn;var je={exports:{}};(function(n){n.exports=e;function e(r){if(r)return t(r)}function t(r){for(var i in e.prototype)r[i]=e.prototype[i];return r}e.prototype.on=e.prototype.addEventListener=function(r,i){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(i),this},e.prototype.once=function(r,i){function s(){this.off(r,s),i.apply(this,arguments)}return s.fn=i,this.on(r,s),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(r,i){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+r];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var o,a=0;a<s.length;a++)if(o=s[a],o===i||o.fn===i){s.splice(a,1);break}return s.length===0&&delete this._callbacks["$"+r],this},e.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var i=new Array(arguments.length-1),s=this._callbacks["$"+r],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if(s){s=s.slice(0);for(var o=0,a=s.length;o<a;++o)s[o].apply(this,i)}return this},e.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]},e.prototype.hasListeners=function(r){return!!this.listeners(r).length}})(je);var Fe=ue,Cn=je.exports;U.protocol=5;var H=U.PacketType={CONNECT:0,DISCONNECT:1,EVENT:2,ACK:3,CONNECT_ERROR:4},Ye=Number.isInteger||function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n},Ze=function(n){return typeof n=="string"},Ke=function(n){return Object.prototype.toString.call(n)==="[object Object]"};function We(){}We.prototype.encode=function(n){return[Fe.encode(n)]};function z(){}Cn(z.prototype),z.prototype.add=function(n){var e=Fe.decode(n);this.checkPacket(e),this.emit("decoded",e)};function wn(n){switch(n.type){case H.CONNECT:return n.data===void 0||Ke(n.data);case H.DISCONNECT:return n.data===void 0;case H.CONNECT_ERROR:return Ze(n.data)||Ke(n.data);default:return Array.isArray(n.data)}}z.prototype.checkPacket=function(n){var e=Ye(n.type)&&n.type>=H.CONNECT&&n.type<=H.CONNECT_ERROR;if(!e)throw new Error("invalid packet type");if(!Ze(n.nsp))throw new Error("invalid namespace");if(!wn(n))throw new Error("invalid payload");var t=n.id===void 0||Ye(n.id);if(!t)throw new Error("invalid packet id")},z.prototype.destroy=function(){},U.Encoder=We,U.Decoder=z;const E=G("https://ccwss.armagan.rest/voice-indicators",{transports:["websocket"],parser:U});E.on("connect",()=>{E.emit(":setUser",{userId:$.getCurrentUser().id})}),E.on(":kill",()=>{E.disconnect()}),E.on("state",({userId:n},e)=>{e({ok:!0,data:fe(n)})}),E.on("members",({channelId:n},e)=>{e({ok:!0,data:He(n)})});function Je(n,e,t=1/0){return new Promise(r=>{let i=!1;E.emit(n,e,s=>{i||r(s)}),t!=1/0&&setTimeout(()=>{i=!0,r({ok:!1,error:"Timeout"})},t)})}class En{constructor(){this.patches=[]}add(...e){this.patches.push(...e)}remove(e){let[t]=this.patches.splice(this.patches.indexOf(r=>r==e),1);t()}removeAll(){let e=this.patches.splice(0,this.patches.length);for(let t=0;t<e.length;t++)e[t]()}}var k=new En;function kn(){k.add((()=>{let n=setInterval(()=>{ee.default.emit("VoiceIndicators:Render")},1e3);return()=>{clearInterval(n)}})())}function Xe({color:n}){return`
    <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        class="vi--icon vi--deaf-icon"
        style="color: ${n};"
      >
      <path d="M6.16204 15.0065C6.10859 15.0022 6.05455 15 6 15H4V12C4 7.588 7.589 4 12 4C13.4809 4 14.8691 4.40439 16.0599 5.10859L17.5102 3.65835C15.9292 2.61064 14.0346 2 12 2C6.486 2 2 6.485 2 12V19.1685L6.16204 15.0065Z" fill="currentColor"></path>
      <path d="M19.725 9.91686C19.9043 10.5813 20 11.2796 20 12V15H18C16.896 15 16 15.896 16 17V20C16 21.104 16.896 22 18 22H20C21.105 22 22 21.104 22 20V12C22 10.7075 21.7536 9.47149 21.3053 8.33658L19.725 9.91686Z" fill="currentColor"></path>
      <path d="M3.20101 23.6243L1.7868 22.2101L21.5858 2.41113L23 3.82535L3.20101 23.6243Z" fill="currentColor"></path>
    </svg>
  `}function Ge({color:n}){return`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      class="vi--icon vi--mute-icon"
      style="color: ${n};"
    >
      <path d="M6.7 11H5C5 12.19 5.34 13.3 5.9 14.28L7.13 13.05C6.86 12.43 6.7 11.74 6.7 11Z" fill="currentColor"></path>
      <path d="M9.01 11.085C9.015 11.1125 9.02 11.14 9.02 11.17L15 5.18V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 11.03 9.005 11.0575 9.01 11.085Z" fill="currentColor"></path>
      <path d="M11.7237 16.0927L10.9632 16.8531L10.2533 17.5688C10.4978 17.633 10.747 17.6839 11 17.72V22H13V17.72C16.28 17.23 19 14.41 19 11H17.3C17.3 14 14.76 16.1 12 16.1C11.9076 16.1 11.8155 16.0975 11.7237 16.0927Z" fill="currentColor"></path>
      <path d="M21 4.27L19.73 3L3 19.73L4.27 21L8.46 16.82L9.69 15.58L11.35 13.92L14.99 10.28L21 4.27Z" fill="currentColor"></path>
    </svg>
  `}function Nn({color:n}){return`
    <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        class="vi--icon vi--video-icon"
        style="color: ${n};"
      >
        <path d="M21.526 8.149C21.231 7.966 20.862 7.951 20.553 8.105L18 9.382V7C18 5.897 17.103 5 16 5H4C2.897 5 2 5.897 2 7V17C2 18.104 2.897 19 4 19H16C17.103 19 18 18.104 18 17V14.618L20.553 15.894C20.694 15.965 20.847 16 21 16C21.183 16 21.365 15.949 21.526 15.851C21.82 15.668 22 15.347 22 15V9C22 8.653 21.82 8.332 21.526 8.149Z" fill="currentColor"></path>
      </svg>
  `}function An({color:n}){return`
    <svg
      width="60"
      height="61"
      viewBox="0 0 60 61"
      fill="none"
      class="vi--icon vi--voice-icon"
      style="color: ${n};"
    >
      <path d="M28.4623 8.15497C27.5273 7.77127 26.4523 7.98305 25.7373 8.69565L15.0048 20.4212H7.50479C6.12979 20.4212 5.00479 21.5449 5.00479 22.9128V37.8623C5.00479 39.2327 6.12979 40.354 7.50479 40.354H15.0048L25.7373 52.0844C26.4523 52.7971 27.5273 53.0113 28.4623 52.6251C29.3973 52.2389 30.0048 51.3295 30.0048 50.3204V10.4547C30.0048 9.45061 29.3973 8.53619 28.4623 8.15497ZM35.0048 12.9461V17.9293C41.8973 17.9293 47.5048 23.5205 47.5048 30.3875C47.5048 37.2569 41.8973 42.8456 35.0048 42.8456V47.8288C44.6548 47.8288 52.5048 40.0076 52.5048 30.3875C52.5048 20.7723 44.6548 12.9461 35.0048 12.9461ZM35.0048 22.9126C39.1398 22.9126 42.5048 26.2689 42.5048 30.3875C42.5048 34.5111 39.1398 37.8623 35.0048 37.8623V32.8791C36.3823 32.8791 37.5048 31.7604 37.5048 30.3875C37.5048 29.0146 36.3823 27.8959 35.0048 27.8959V22.9126Z" fill="currentColor"></path>
    </svg>
  `}const g={DANGER:"#eb3d47",SECONDARY:"#8a8e93",SUCCESS:"#3aa360",PRIMARY:"#5865f2"};let _n={guildDeaf:Xe({color:g.DANGER}),deaf:Xe({color:g.SECONDARY}),guildMute:Ge({color:g.DANGER}),mute:Ge({color:g.SECONDARY}),video:Nn({color:g.SECONDARY}),stream:'<div class="v--icon vi--red-dot" ></div>',normal:An({color:g.SECONDARY})};function Tn(n,e=!1){let t=e?n:n.state;return _n[t]||t}const y={lastVoiceStates:[],responseCache:new Map,stateRequestCache:[]};async function Rn(n){let e=y.responseCache.get(`Users:${n}`);if(e)return e.states;let t=await new Promise(r=>y.stateRequestCache.push([n,r]));return y.responseCache.set(`Users:${n}`,{at:Date.now(),states:t,ttl:1e3}),t}async function On(n){let e=He(n);if(!e.length){let t=y.responseCache.get(`VoiceMembers:${n}`);if(t)return t.members;e=((await Je("members",{id:n}))?.data||[]).map(Q),y.responseCache.set(`VoiceMembers:${n}`,{at:Date.now(),members:e,ttl:1e3})}return e}function Qe(n={}){return d.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"vi--icon vi--arrow-icon",style:{color:n.color}},d.createElement("polygon",{fill:"currentColor","fill-rule":"nonzero",points:"13 20 11 20 11 8 5.5 13.5 4.08 12.08 12 4.16 19.92 12.08 18.5 13.5 13 8"}))}function Sn(n={}){return d.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"vi--icon vi--close-icon",style:{color:n.color}},d.createElement("path",{d:"M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z",fill:"currentColor"}))}function et(n={}){return d.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"vi--icon vi--deaf-icon",style:{color:n.color}},d.createElement("path",{d:"M6.16204 15.0065C6.10859 15.0022 6.05455 15 6 15H4V12C4 7.588 7.589 4 12 4C13.4809 4 14.8691 4.40439 16.0599 5.10859L17.5102 3.65835C15.9292 2.61064 14.0346 2 12 2C6.486 2 2 6.485 2 12V19.1685L6.16204 15.0065Z",fill:"currentColor"}),d.createElement("path",{d:"M19.725 9.91686C19.9043 10.5813 20 11.2796 20 12V15H18C16.896 15 16 15.896 16 17V20C16 21.104 16.896 22 18 22H20C21.105 22 22 21.104 22 20V12C22 10.7075 21.7536 9.47149 21.3053 8.33658L19.725 9.91686Z",fill:"currentColor"}),d.createElement("path",{d:"M3.20101 23.6243L1.7868 22.2101L21.5858 2.41113L23 3.82535L3.20101 23.6243Z",fill:"currentColor"}))}function In(n={}){return d.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"vi--icon vi--join-call-icon",style:{color:n.color}},d.createElement("path",{fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd",d:"M11 5V3C16.515 3 21 7.486 21 13H19C19 8.589 15.411 5 11 5ZM17 13H15C15 10.795 13.206 9 11 9V7C14.309 7 17 9.691 17 13ZM11 11V13H13C13 11.896 12.105 11 11 11ZM14 16H18C18.553 16 19 16.447 19 17V21C19 21.553 18.553 22 18 22H13C6.925 22 2 17.075 2 11V6C2 5.447 2.448 5 3 5H7C7.553 5 8 5.447 8 6V10C8 10.553 7.553 11 7 11H6C6.063 14.938 9 18 13 18V17C13 16.447 13.447 16 14 16Z"}))}function tt(n={}){return d.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"vi--icon vi--mute-icon",style:{color:n.color}},d.createElement("path",{d:"M6.7 11H5C5 12.19 5.34 13.3 5.9 14.28L7.13 13.05C6.86 12.43 6.7 11.74 6.7 11Z",fill:"currentColor"}),d.createElement("path",{d:"M9.01 11.085C9.015 11.1125 9.02 11.14 9.02 11.17L15 5.18V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 11.03 9.005 11.0575 9.01 11.085Z",fill:"currentColor"}),d.createElement("path",{d:"M11.7237 16.0927L10.9632 16.8531L10.2533 17.5688C10.4978 17.633 10.747 17.6839 11 17.72V22H13V17.72C16.28 17.23 19 14.41 19 11H17.3C17.3 14 14.76 16.1 12 16.1C11.9076 16.1 11.8155 16.0975 11.7237 16.0927Z",fill:"currentColor"}),d.createElement("path",{d:"M21 4.27L19.73 3L3 19.73L4.27 21L8.46 16.82L9.69 15.58L11.35 13.92L14.99 10.28L21 4.27Z",fill:"currentColor"}))}function Ln(n={}){return d.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"vi--icon vi--video-icon",style:{color:n.color}},d.createElement("path",{d:"M21.526 8.149C21.231 7.966 20.862 7.951 20.553 8.105L18 9.382V7C18 5.897 17.103 5 16 5H4C2.897 5 2 5.897 2 7V17C2 18.104 2.897 19 4 19H16C17.103 19 18 18.104 18 17V14.618L20.553 15.894C20.694 15.965 20.847 16 21 16C21.183 16 21.365 15.949 21.526 15.851C21.82 15.668 22 15.347 22 15V9C22 8.653 21.82 8.332 21.526 8.149Z",fill:"currentColor"}))}function nt(n={}){return d.createElement("svg",{width:"60",height:"61",viewBox:"0 0 60 61",fill:"none",className:"vi--icon vi--voice-icon",style:{color:n.color}},d.createElement("path",{d:"M28.4623 8.15497C27.5273 7.77127 26.4523 7.98305 25.7373 8.69565L15.0048 20.4212H7.50479C6.12979 20.4212 5.00479 21.5449 5.00479 22.9128V37.8623C5.00479 39.2327 6.12979 40.354 7.50479 40.354H15.0048L25.7373 52.0844C26.4523 52.7971 27.5273 53.0113 28.4623 52.6251C29.3973 52.2389 30.0048 51.3295 30.0048 50.3204V10.4547C30.0048 9.45061 29.3973 8.53619 28.4623 8.15497ZM35.0048 12.9461V17.9293C41.8973 17.9293 47.5048 23.5205 47.5048 30.3875C47.5048 37.2569 41.8973 42.8456 35.0048 42.8456V47.8288C44.6548 47.8288 52.5048 40.0076 52.5048 30.3875C52.5048 20.7723 44.6548 12.9461 35.0048 12.9461ZM35.0048 22.9126C39.1398 22.9126 42.5048 26.2689 42.5048 30.3875C42.5048 34.5111 39.1398 37.8623 35.0048 37.8623V32.8791C36.3823 32.8791 37.5048 31.7604 37.5048 30.3875C37.5048 29.0146 36.3823 27.8959 35.0048 27.8959V22.9126Z",fill:"currentColor"}))}const rt=D.default.findByProps("thin","scrollerBase"),Bn={guildDeaf:et({color:g.DANGER}),deaf:et({color:g.SECONDARY}),guildMute:tt({color:g.DANGER}),mute:tt({color:g.SECONDARY}),video:Ln({color:g.SECONDARY}),stream:l.createElement("div",{class:"v--icon vi--red-dot"}),normal:nt({color:g.SECONDARY})};function Vn({e:n,states:e}){const[t,r]=l.useState({inMyChannels:!1,isJoinable:!1,state:e[0]}),[i,s]=l.useState([]);async function o(a){let c=he.getChannel(a.channelId),u=!!c,h=u?c.type==3?!0:Ue.can(qe.CONNECT,c)&&Ue.can(qe.VIEW_CHANNEL,c):!1;r({inMyChannels:u,isJoinable:h,state:a}),s(a.channelRedacted?[]:await On(a.channelId))}return l.useEffect(()=>{o(e[0])},[]),l.createElement(un,{transitionState:n.transitionState,size:"large",className:"vi--modal-root"},l.createElement("div",{className:"vi--modal-header"},l.createElement("div",{className:"title"},m.i18n.format("VOICE_STATES")),l.createElement("div",{onClick:n.onClose,className:"vi--modal-close"},l.createElement(Sn,{color:g.SECONDARY}))),l.createElement("div",{className:"vi--modal-content"},l.createElement("div",{className:`tabs ${rt.thin}`},e.map(a=>l.createElement("div",{className:`item ${a.channelId===t.state.channelId?"active":""}`,onClick:()=>{o(a)}},l.createElement("div",{className:"content"},l.createElement("div",{className:"icon",style:{backgroundImage:a.guildId?`url('https://cdn.discordapp.com/icons/${a.guildId}/${a.guildIcon}.png?size=128')`:a.channelId?`url('https://cdn.discordapp.com/channel-icons/${a.channelId}/${a.channelIcon}.png?size=128')`:null}}),l.createElement("div",{className:"name","acord--tooltip-content":a.guildName||m.i18n.format("PRIVATE_CALL")},a.guildId?a.guildName:m.i18n.format("PRIVATE_CALL")),a.guildVanity?l.createElement("div",{className:"vanity",onClick:c=>{c.preventDefault(),a.guildVanity&&(ln.acceptInviteAndTransitionToInviteChannel({inviteKey:a.guildVanity}),n.onClose())}},l.createElement("div",{"acord--tooltip-content":m.i18n.format("JOIN_GUILD")},l.createElement(Qe,{color:g.PRIMARY}))):null)))),l.createElement("div",{className:"content"},l.createElement("div",{className:"channel"},l.createElement("div",{className:"name-container"},l.createElement("div",{className:"name"},l.createElement(nt,null),t.state.channelName||m.i18n.format("UNKNOWN")),l.createElement("div",{className:"controls"},l.createElement("div",{className:`control ${t.isJoinable?"":"vi--cant-click vi--cant-join"}`,onClick:a=>{a.preventDefault(),t.isJoinable&&(te.default.show(m.i18n.format("X_JOIN_CHANNEL",t.state.channelName)),dn(t.state.channelId),n.onClose())}},l.createElement("div",{"acord--tooltip-content":m.i18n.format(`${t.isJoinable?"":"CANT_"}JOIN`)},l.createElement(In,{color:g.SECONDARY}))),l.createElement("div",{className:`control ${t.inMyChannels?"":"vi--cant-click"}`,onClick:a=>{a.preventDefault(),t.inMyChannels&&(te.default.show(m.i18n.format("X_VIEW_CHANNEL",t.state.channelName)),hn(`/channels/${t.state.guildId||"@me"}/${t.state.channelId}`),n.onClose())}},l.createElement("div",{"acord--tooltip-content":m.i18n.format(`${t.inMyChannels?"":"CANT_"}VIEW`)},l.createElement(Qe,{color:g.SECONDARY}))))),l.createElement("div",{className:"members-container"},l.createElement("div",{className:`members ${rt.thin}`},i.map(a=>l.createElement("div",{className:"member",onClick:async c=>{c.preventDefault();try{if(!ye.default.show.user)throw Error("Old Acord version");await ye.default.show.user(a.userId)}catch{Y.default.copyText(a.userTag),te.default.show(m.i18n.format("X_COPIED",a.userTag))}}},l.createElement("div",{className:"avatar",style:{backgroundImage:`url("${a.userAvatar?`https://cdn.discordapp.com/avatars/${a.userId}/${a.userAvatar}.png?size=128`:`https://cdn.discordapp.com/embed/avatars/${Number(a.userTag.split("#")[1])%5}.png`}")`}}),l.createElement("div",{className:"about"},l.createElement("div",{className:"name-container"},l.createElement("div",{className:"name"},a.userTag.split("#")[0]),l.createElement("div",{className:"discriminator"},"#",a.userTag.split("#")[1])),l.createElement("div",{className:"state"},Bn[a?.state]||null))))))))))}async function Dn(n){fn(e=>d.createElement(Vn,{e,states:n}))}const Mn=[D.default.findByProps("bot","nameTag").nameTag,D.default.findByProps("wrappedName","nameAndDecorators").nameAndDecorators,D.default.findByProps("wrappedName","nameAndDecorators","selected").nameAndDecorators];async function Pn(n,e){if(m.persist.ghost.settings.ignoreBots&&n.bot)return;let t=ge.default.parseHTML('<span class="vi--patched vi--icon-container vi--hidden"></span>');t.render=async()=>{let i=await Rn(n.id);t.states=i;let s=i[0];if(!s){t.innerHTML="",t.state=null,t.classList.add("vi--hidden"),t.setAttribute("acord--tooltip-content","");return}if(_.isEqual(s,t.state))return;let o=Q(s),a=he.getChannel(o.channelId);t.classList.remove("vi--hidden"),t.classList[a?"remove":"add"]("vi--cant-join");let c=`(${i.length}) ${a?"\u2705":"\u274C"} ${o.guildId?o.guildName||"Unknown Guild":m.i18n.format("PRIVATE_CALL")} > ${o.channelName||"Plugin Deprecated"}`;t.setAttribute("acord--tooltip-content",c),t.replaceChildren(ge.default.parseHTML(Tn(o))),t.state=s};let r=ee.default.on("VoiceIndicators:Render",t.render);t.unmount=()=>{r()},t.render(),t.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),!m.persist.ghost.settings?.redacted&&Dn(t.states.map(Q))}),e.appendChild(t)}let L={};const $n=(n,e)=>{Date.now()-(L[n.id]||0)>100&&(L[n.id]=Date.now(),Pn(n,e))};function Un(){k.add((()=>{let n=setInterval(()=>{for(const e in L)Date.now()-L[e]>1e3&&delete L[e]},1e4);return()=>{L={},clearInterval(n)}})()),k.add(ee.default.on("domMutation",n=>{n.addedNodes.forEach(e=>{e.nodeType!==Node.TEXT_NODE&&e.querySelectorAll(Mn.map(t=>`.${t}`).join(", ")).forEach(async t=>{if(t.querySelector(".vi--patched"))return;let r=Y.default.react.getProps(t,i=>!!i?.user)?.user;!r||$n(r,t)})}),n.removedNodes.forEach(e=>{if(e.nodeType===Node.TEXT_NODE)return;e.querySelectorAll(".vi--patched").forEach(async r=>{typeof r.unmount=="function"&&r.unmount()})})}))}var qn=()=>yt.injectCSS(".vi--icon-container{display:inline-flex;align-items:center;justify-content:center;background-color:#00000080;border-radius:50%;width:18px;height:18px;min-width:18px;min-height:18px;margin-left:4px;z-index:99}.vi--icon{display:flex;transition:filter .1s ease-in-out;color:#fff;width:14px;height:14px}.vi--icon:hover{filter:brightness(1.2)}.vi--red-dot{width:10px;height:10px;border-radius:50%;background-color:#ed4245;box-shadow:0 0 4px #ed4245}.vi--hidden{display:none!important}.vi--modal-root{display:flex;flex-direction:column}.vi--modal-root .vi--modal-header{display:flex;align-items:center;justify-content:space-between;padding:16px}.vi--modal-root .vi--modal-header .title{font-size:28px;font-weight:600;color:#efefef}.vi--modal-root .vi--modal-header .vi--modal-close{width:24px;height:24px}.vi--modal-root .vi--modal-header .vi--modal-close svg{width:24px;height:24px}.vi--modal-root .vi--modal-content{padding:0 16px 16px;display:flex;flex-direction:column}.vi--modal-root .vi--modal-content .tabs{display:flex;gap:4px;overflow-x:auto;padding-bottom:2px}.vi--modal-root .vi--modal-content .tabs .item{width:fit-content;display:flex;align-items:center;justify-content:center;padding:8px;opacity:.75;background-color:#00000040;border-top-left-radius:8px;border-top-right-radius:8px;cursor:pointer;border-bottom:2px solid transparent}.vi--modal-root .vi--modal-content .tabs .item>.content{display:flex;align-items:center;gap:4px}.vi--modal-root .vi--modal-content .tabs .item>.content .icon{width:32px;height:32px;min-width:32px;min-height:32px;background-position:center;background-size:contain;border-radius:50%;background-color:#5865f2}.vi--modal-root .vi--modal-content .tabs .item>.content .name{font-size:16px;color:#efefef;max-width:128px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.vi--modal-root .vi--modal-content .tabs .item>.content .vanity svg{width:14px;height:14px}.vi--modal-root .vi--modal-content .tabs .item:hover{opacity:.85;border-bottom:2px solid rgba(255,255,255,.75)}.vi--modal-root .vi--modal-content .tabs .item.active{opacity:1;border-bottom:2px solid white}.vi--modal-root .vi--modal-content>.content{margin-top:8px}.vi--modal-root .vi--modal-content>.content>.channel>.name-container{display:flex;align-items:center;justify-content:space-between;background-color:#00000040;padding:8px;border-radius:8px}.vi--modal-root .vi--modal-content>.content>.channel>.name-container>.name{display:flex;font-size:20px;font-weight:400;color:#efefef;align-items:center}.vi--modal-root .vi--modal-content>.content>.channel>.name-container>.name svg{margin-right:8px;width:24px;height:24px;pointer-events:none}.vi--modal-root .vi--modal-content>.content>.channel>.name-container>.controls{display:flex}.vi--modal-root .vi--modal-content>.content>.channel>.name-container>.controls>.control{padding:4px;cursor:pointer}.vi--modal-root .vi--modal-content>.content>.channel>.name-container>.controls>.control svg{width:24px;height:24px}.vi--modal-root .vi--modal-content>.content>.channel>.members-container{padding:8px 8px 8px 40px}.vi--modal-root .vi--modal-content>.content>.channel>.members-container>.members{display:flex;flex-direction:column;overflow:auto;max-height:500px;height:100%}.vi--modal-root .vi--modal-content>.content>.channel>.members-container>.members .member{display:flex;margin-bottom:4px;cursor:pointer;width:min-content;align-items:center}.vi--modal-root .vi--modal-content>.content>.channel>.members-container>.members .member>.avatar{width:32px;height:32px;border-radius:50%;background-position:center;background-size:contain;margin-right:8px;background-color:#5865f2}.vi--modal-root .vi--modal-content>.content>.channel>.members-container>.members .member>.about{border-radius:9999px;background-color:#0003;display:flex;align-items:center;padding:8px}.vi--modal-root .vi--modal-content>.content>.channel>.members-container>.members .member>.about>.name-container{display:flex;align-items:center;width:max-content;font-size:16px;color:#dfdfdf}.vi--modal-root .vi--modal-content>.content>.channel>.members-container>.members .member>.about>.name-container .name{width:100%}.vi--modal-root .vi--modal-content>.content>.channel>.members-container>.members .member>.about>.name-container .discriminator{opacity:.5}.vi--modal-root .vi--modal-content>.content>.channel>.members-container>.members .member>.about>.state{background-color:transparent;margin-left:4px}.vi--modal-root .vi--modal-content>.content>.channel>.members-container>.members .member>.about>.state svg{width:16px;height:16px}[class*=userText-] [class*=nameTag-],[class*=topSection-] [class*=nameTag-]{display:flex;align-items:center}[class*=userText-] [class*=nameTag-] *,[class*=topSection-] [class*=nameTag-] *{overflow:hidden}[class*=vi--],[class*=vi--] *{box-sizing:border-box}.vi--cant-join{opacity:.75}.vi--cant-click{cursor:default!important}");function Hn(){k.add(qn())}var b={},j={},F={};F.isThenable=function(e){return e!=null&&typeof e.then=="function"},F.isArrayLike=function(e){return e!=null&&typeof e.length=="number"&&e.length>=0};const{isArrayLike:zn}=F;j.forEach=function(n,e,t){let r=0,i;if(zn(n))return i=n.length,{next(){if(r>=i)return[!0,null];const o=e.call(t,n[r],r,n);return r++,[!1,o]}};const s=Object.keys(n);return i=s.length,{next(){if(r>=i)return[!0,null];const o=s[r++],a=e.call(t,n[o],o,n);return[!1,a]}}},j.repeat=function(n,e,t){let r,i,s;return n&&typeof n=="object"?(r=n.start||0,i=n.step||1,s=n.done):(r=0,i=1,s=n),{next(){const o=e.call(t,r);return r+=i,r>=s?[!0,o]:[!1,o]}}},j.until=function(n,e){return{next(){const t=n.call(e);return[!1,t]}}},j.forOf=function(n,e,t){const r=n[Symbol.iterator]();return{next(){const i=r.next();if(i.done)return[!0,null];const s=e.call(t,i.value,n);return[!1,s]}}};var st={},it=(()=>{if(typeof setImmediate=="function")return n=>{setImmediate(n)};if(typeof process=="object"&&typeof process.nextTick=="function")return n=>{process.nextTick(n)};if(typeof MessageChannel=="function"){const n=new MessageChannel;let e={},t=e;return n.port1.onmessage=()=>{e=e.next;const r=e.task;delete e.task,r()},r=>{t=t.next={task:r},n.port2.postMessage(0)}}return n=>{setTimeout(n,0)}})();const{isThenable:jn}=F,ot=st,at=it,ct=1500;var Fn=function(e,t=0){return new Promise((r,i)=>{let s=0;function o(){const a=Date.now();let c;try{for(;;){const[u,h]=e.next();if(jn(h)){h.then(N=>{u?r(N):N===ot?r():o()},i);return}if(u){r(h);return}if(h===ot){r();return}if(t>0||(c=Date.now()-a,s+=c,s>1e3))break;if(!(c<10))break}}catch(u){i(u);return}if(t>0){const u=Math.min(ct,Date.now()-a+t);setTimeout(o,u)}else{const u=Math.min(ct,c/3);s=0,u>10?setTimeout(o,u):at(o)}}at(o)})},Yn="chillout",Zn="Reduce CPU usage by non-blocking async loop and psychologically speed up in JavaScript",Kn="5.0.0",Wn="polygon planet <polygon.planet.aqua@gmail.com>",Jn={url:"https://github.com/polygonplanet/chillout/issues"},Xn={"@babel/core":"^7.8.3","@babel/preset-env":"^7.8.3",babelify:"^10.0.0",bannerify:"^1.0.1",browserify:"^16.5.0","es6-shim":"^0.35.5",eslint:"^6.8.0",karma:"^4.4.1","karma-browserify":"^6.1.0","karma-chrome-launcher":"^3.1.0","karma-detect-browsers":"^2.3.3","karma-es6-shim":"^1.0.0","karma-firefox-launcher":"^1.3.0","karma-ie-launcher":"^1.0.0","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-safari-launcher":"^1.0.0",mocha:"^7.0.0","package-json-versionify":"^1.0.4",pidusage:"1.0.2","power-assert":"^1.6.1","uglify-js":"^3.7.5",uglifyify:"^5.0.2",watchify:"^3.11.1"},Gn={node:">=8.10.0"},Qn=["dist/*","src/*"],er="https://github.com/polygonplanet/chillout",tr=["acceleration","async await","asynchronous","cpu use rate","cpu utilization rate","heavy processing","iterate","iteration","lightweight","nextTick","non-blocking","optimization","optimize for loop","performance","promise","reduce cpu usage","setimmediate","waitUntil"],nr="MIT",rr="src/index.js",sr={type:"git",url:"https://github.com/polygonplanet/chillout.git"},ir={benchmark:"node benchmark/benchmark",build:"npm run compile && npm run minify",compile:"browserify src/index.js -o dist/chillout.js -s chillout -p [ bannerify --file src/banner.js ] --no-bundle-external --bare",minify:"uglifyjs dist/chillout.js -o dist/chillout.min.js --comments -c -m -b ascii_only=true,beautify=false",test:"./node_modules/.bin/eslint . && npm run build && mocha test/**/*.spec.js --timeout 10000 && karma start karma.conf.js",travis:"npm run build && mocha test/**/*.spec.js --timeout 10000 && karma start karma.conf.js --single-run",watch:"watchify src/index.js -o dist/chillout.js -s chillout -p [ bannerify --file src/banner.js ] --no-bundle-external --bare --poll=200 -v"},or={transform:["babelify","package-json-versionify"]},ar={name:Yn,description:Zn,version:Kn,author:Wn,bugs:Jn,devDependencies:Xn,engines:Gn,files:Qn,homepage:er,keywords:tr,license:nr,main:rr,repository:sr,scripts:ir,browserify:or};const B=j,V=Fn,{isThenable:cr,isArrayLike:lr}=F,hr=it,fr=st;b.version=ar.version,b.forEach=function(e,t,r){return V(B.forEach(e,t,r))},b.repeat=function(e,t,r){return V(B.repeat(e,t,r))},b.until=function(e,t){return V(B.until(e,t))};const ur=13;b.waitUntil=function(e,t){return V(B.until(e,t),ur)},b.forOf=function(e,t,r){return V(B.forOf(e,t,r))},b.StopIteration=fr,b.iterate=V,b.iterator=B,b.isThenable=cr,b.isArrayLike=lr,b.nextTick=hr;function dr(){k.add((()=>{let n=0;y.lastVoiceStates=[];async function e(){if(n)return;let t=pn();E.emit("bulkUpdate",t),await new Promise(r=>setTimeout(r,m.persist.ghost.settings.performanceMode?1e4:5e3)),e()}return e(),()=>{n=1,y.lastVoiceStates=[]}})()),k.add(Y.default.interval(()=>{y.lastVoiceStates=[]},6e4*30))}function pr(){k.add(()=>{y.lastVoiceStates=[],y.responseCache=new Map,y.stateRequestCache=[]}),k.add(Y.default.interval(()=>{y.responseCache.forEach((n,e)=>{Date.now()-n.at>n.ttl&&y.responseCache.delete(e)})},1e3)),k.add((()=>{let n=0;async function e(){n||(y.stateRequestCache[0]&&(async()=>{let t=[...y.stateRequestCache];y.stateRequestCache=[];let r=(await Je("bulkState",[...new Set(t.map(i=>i[0]))]))?.data||[];await b.forEach(r,i=>{t.filter(o=>o[0]===i[0]).forEach(o=>{o[1](i[1]||[])})})})(),await new Promise(t=>setTimeout(t,m.persist.ghost.settings.performanceMode?1e3:5e3)),e())}return e(),()=>{n=1}})())}var mr={load(){Un(),Hn(),kn(),pr(),dr(),E.connect()},unload(){k.removeAll(),E.disconnect()},settings:{data:[{type:"header",name:"Privacy"},{type:"checkbox",name:"Do Not Share Private Data",description:"When this setting is on, your private information will not be shared with the other party. However, you will not be able to see other people's private information.",property:"redacted",value:!1},{type:"header",name:"Other"},{type:"checkbox",name:"Ignore Bots",description:"Do not show voice indicators on bots.",property:"ignoreBots",value:!0},{type:"checkbox",name:"Performance Mode",description:"Slower checks.",property:"performanceMode",value:!1}]}};return mr})(acord.modules.webpack,acord.modules.common,acord.extension,acord.events,acord.dom,acord.utils,acord.modules.common.React,acord.ui.toasts,acord.ui.modals,acord.patcher);
