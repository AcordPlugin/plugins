(function(N,D,k,j,o,d,z,R){"use strict";function E(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}function B(n){if(n&&n.__esModule)return n;var b=Object.create(null);return n&&Object.keys(n).forEach(function(f){if(f!=="default"){var x=Object.getOwnPropertyDescriptor(n,f);Object.defineProperty(b,f,x.get?x:{enumerable:!0,get:function(){return n[f]}})}}),b.default=n,Object.freeze(b)}var y=E(N),q=E(D),C=B(z),L=E(R),U=()=>j.injectCSS(".tabs--container{box-sizing:border-box;display:flex;flex-direction:column;width:100%;-webkit-app-region:drag}.tabs--container>.tab-items,.tabs--container>.bookmarks{box-sizing:border-box;display:flex;align-items:center;width:100%;--item-h: 30px;height:var(--item-h);min-height:var(--item-h);gap:4px;padding:0 4px;transition:.1s ease-in-out opacity;-webkit-app-region:drag}.tabs--container>.bookmarks{height:var(--item-h);min-height:var(--item-h);background-color:#0000001a;-webkit-app-region:no-drag}.tabs--container>.bookmarks.hidden{display:none}.tabs--container .new-tab{color:#fff;width:12px;height:12px;transform:rotate(45deg);cursor:pointer;margin-left:4px;-webkit-app-region:no-drag}.tabs--container .bookmark-item{-webkit-app-region:no-drag;background-color:#00000040;border-radius:4px;display:flex;align-items:center;justify-content:center;padding:6px;cursor:pointer;opacity:.5;transition:.1s ease-in-out opacity;position:relative}.tabs--container .bookmark-item:hover,.tabs--container .bookmark-item.selected{opacity:1}.tabs--container .bookmark-item .unread{position:absolute;right:-3px;top:-3px;border-radius:50%;background-color:#ed4245;width:12px;height:12px;font-size:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:400}.tabs--container .bookmark-item .unread.plus{font-size:8px}.tabs--container .bookmark-item .unread.hidden{display:none}.tabs--container .bookmark-item .info{display:flex;align-items:center;justify-content:flex-start;gap:4px}.tabs--container .bookmark-item .icon{border-radius:2px;width:8px;height:8px;background-size:cover;background-position:center;background-repeat:no-repeat}.tabs--container .bookmark-item .title{font-size:12px;color:#fff;text-overflow:ellipsis;word-break:keep-all;overflow:hidden;white-space:nowrap;max-width:150px}.tabs--container .tab-item{-webkit-app-region:no-drag;color:#fff;background-color:#00000040;box-sizing:border-box;width:fit-content;height:var(--item-h);display:flex;align-items:center;justify-content:space-between;padding:0 8px;gap:8px;border-top-left-radius:8px;border-top-right-radius:8px;cursor:pointer;opacity:.5;position:relative}.tabs--container .tab-item .unread{position:absolute;right:-4px;top:-4px;border-radius:50%;background-color:#ed4245;width:14px;height:14px;font-size:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:400}.tabs--container .tab-item .unread.plus{font-size:8px}.tabs--container .tab-item .unread.hidden{display:none}.tabs--container .tab-item .info{display:flex;align-items:center;justify-content:flex-start;gap:8px}.tabs--container .tab-item .icon{border-radius:4px;width:14px;height:14px;background-size:cover;background-position:center;background-repeat:no-repeat}.tabs--container .tab-item .title{font-size:14px;text-overflow:ellipsis;word-break:keep-all;overflow:hidden;white-space:nowrap;min-width:150px;max-width:250px}.tabs--container .tab-item .close{color:#ffffff80;width:12px;height:12px;cursor:pointer;transition:.1s ease-in-out opacity}.tabs--container .tab-item .close.hidden{opacity:0;pointer-events:none}.tabs--container .tab-item.disabled{opacity:.5;pointer-events:none}.tabs--container .tab-item:hover,.tabs--container .tab-item.selected{opacity:1}[class*=small-].tabs--rename-modal{height:40px!important;min-height:40px!important;min-width:400px!important}");function I(){return`
  <svg viewBox="0 0 12 12">
    <polygon fill="currentColor" fill-rule="evenodd" points="11 1.576 6.583 6 11 10.424 10.424 11 6 6.583 1.576 11 1 10.424 5.417 6 1 1.576 1.576 1 6 5.417 10.424 1"></polygon>
  </svg>
  `}let _=L.default.findByProps("inputDefault","copyInput"),G=L.default.findByProps("input","editable","disabled","inputWrapper");function P(n={}){return C.createElement("div",{className:`${G?.input}`},C.createElement("div",{className:`${_?.inputWrapper}`},C.createElement("input",{type:"text",className:`${_?.inputDefault}`,...n})))}var H={load(){o.subscriptions.push(U()),o.subscriptions.push((()=>{const n=y.default.parseHTML(`
                <div class="tabs--container">
                    <div class="tab-items"></div>
                    <div class="bookmarks"></div>
                </div>
            `),b=n.querySelector(".tab-items"),f=n.querySelector(".bookmarks");q.default.ifExists(document.querySelector('div[class*="bg-"]'),t=>t.remove()),document.querySelector('[class*="appDevToolsWrapper-"]').insertAdjacentElement("beforebegin",n);function x(){f.classList[f.childElementCount===0?"add":"remove"]("hidden"),document.querySelectorAll(".bookmark-item").forEach(t=>t.classList.remove("selected")),q.default.ifExists(document.querySelector(`.bookmark-item[data-pathname="${location.pathname}"]`),t=>{t.classList.add("selected")})}let M=y.default.parseHTML(`
                <div class="new-tab">
                    ${I()}
                </div>
            `);M.onclick=()=>{v(o.i18n.format("LOADING"),"/channels/@me",null,!0)},b.appendChild(M);function $(t,e,s){let c=Math.random().toString(36).slice(2),a=y.default.parseHTML(`
                    <div class="bookmark-item" data-id="${c}">
                        <span class="info">
                            <span class="icon" style="${s||"background-color: #5865f2;"}"></span>
                            <span class="title">${y.default.escapeHTML(t)}</span>
                        </span>
                        <span class="unread hidden">0</span>
                    </div>
                `);a.setAttribute("data-pathname",e);async function i(){await new Promise(l=>setTimeout(l,1));let h=document.querySelector(`.tab-item[data-pathname="${e}"]`);if(h)h.select();else{let l=v(o.i18n.format("LOADING"),e,null);await new Promise(p=>setTimeout(p,1)),l.select(),await new Promise(p=>setTimeout(p,1)),T(l)}w()}function m(){a.remove(),w()}return a.select=i,a.close=m,a.onclick=async()=>{location.pathname!==a.getAttribute("data-pathname")&&i()},a.oncontextmenu=h=>{k.contextMenus.open(h,k.contextMenus.build.menu([{type:"text",label:o.i18n.format("DELETE"),action(){m()}},{type:"text",label:o.i18n.format("RENAME"),action(){let l=a.querySelector(".title"),p=l.textContent,u="";d.modals.actions.show(A=>d.React.createElement(d.modals.ModalRoot,{transitionState:A.transitionState,className:"tabs--rename-modal"},d.React.createElement(P,{onChange:r=>{u=r.target.value.trim()||p},placeholder:`${o.i18n.format("RENAME")}: ${l.textContent}`,onKeyUp:r=>{r.code==="Enter"&&(A.onClose(),l.textContent=u,w())}})))}}]))},f.appendChild(a),a}function v(t,e,s,c){let a=Math.random().toString(36).slice(2),i=y.default.parseHTML(`
                    <div class="tab-item" data-id="${a}">
                        <span class="info">
                            <span class="icon" style="${s||"background-color: #5865f2;"}"></span>
                            <span class="title">${y.default.escapeHTML(t)}</span>
                        </span>
                        <span class="close">
                            ${I()}
                        </span>
                        <span class="unread hidden">0</span>
                    </div>
                `);i.setAttribute("data-pathname",e);async function m(){await new Promise(l=>setTimeout(l,1)),d.Router.transitionTo(i.getAttribute("data-pathname")),document.querySelectorAll(".selected").forEach(l=>l.classList.remove("selected")),i.classList.add("selected"),document.querySelectorAll(".close.hidden").forEach(l=>l.classList.remove("hidden")),document.querySelectorAll(".tab-item").length===1&&document.querySelector(".close").classList.add("hidden"),S()}function h(){i.remove(),document.querySelector(".tab-item").select(),document.querySelectorAll(".tab-item").length===1&&document.querySelector(".close").classList.add("hidden"),S()}return i.select=m,i.close=h,i.onclick=async()=>{location.pathname!==i.getAttribute("data-pathname")&&m()},i.oncontextmenu=l=>{let p=[...document.querySelectorAll(".tab-item")],u=p.findIndex(r=>r.getAttribute("data-id")===a),A=p.filter((r,g)=>g>u);k.contextMenus.open(l,k.contextMenus.build.menu([{type:"text",label:o.i18n.format("CLOSE"),disabled:!!i.querySelector(".close.hidden"),action(){h()}},{type:"text",label:o.i18n.format("CLOSE_TABS_TO_RIGHT"),disabled:!A.length,action(){p.filter((r,g)=>g!=u).forEach(r=>r.close())}},{type:"separator"},{type:"text",label:o.i18n.format("MOVE_TAB_TO_LEFT"),disabled:!u,action(){let r=[...p],[g]=r.splice(u,1);r.splice(u-1,0,g),b.replaceChildren(...r),S()}},{type:"text",label:o.i18n.format("MOVE_TAB_TO_RIGHT"),disabled:u===p.length-1,action(){let r=[...p],[g]=r.splice(u,1);r.splice(u+1,0,g),b.replaceChildren(...r),S()}},{type:"separator"},{type:"text",label:o.i18n.format("ADD_TO_BOOKMARKS"),disabled:!!document.querySelector(`.bookmark-item[data-pathname="${i.getAttribute("data-pathname")}"]`),action(){$(i.querySelector(".title").textContent,i.getAttribute("data-pathname"),i.querySelector(".icon").getAttribute("style")),w()}}]))},i.querySelector(".close").onclick=()=>{document.querySelectorAll(".tab-item").length!==1&&h()},b.querySelector(".new-tab").insertAdjacentElement("beforebegin",i),c&&(T(i),m()),i}function S(){let t=d.UserStore.getCurrentUser().id;o.persist.store.userTabs[t]=[...document.querySelectorAll(".tab-item")].map(e=>({pathname:e.getAttribute("data-pathname"),title:e.querySelector(".title").textContent,icon:e.querySelector(".icon").getAttribute("style"),selected:e.classList.contains("selected")}))}function w(){let t=d.UserStore.getCurrentUser().id;o.persist.store.userBookmarks[t]=[...document.querySelectorAll(".bookmark-item")].map(e=>({pathname:e.getAttribute("data-pathname"),title:e.querySelector(".title").textContent,icon:e.querySelector(".icon").getAttribute("style")}))}async function T(t){await new Promise(a=>setTimeout(a,1));let e=window.location.pathname;t.setAttribute("data-pathname",e),t.querySelector(".title").textContent=document.title;let s=e.split("/"),c="";if(s[1]==="channels")if(s[2]==="@me"){let a=d.ChannelStore.getChannel(s[3]);if(a){if(a.isGroupDM()&&a.icon)c=`url('https://cdn.discordapp.com/channel-icons/${a.id}/${a.icon}.webp?size=32')`;else if(a.isDM()){let i=a.getRecipientId(),m=d.UserStore.getUser(i);m?.avatar?c=`url('https://cdn.discordapp.com/avatars/${i}/${m.avatar}.webp?size=32')`:c=`url('https://cdn.discordapp.com/embed/avatars/${m.discriminator%5}.png')`}}}else{let a=d.GuildStore.getGuild(s[2]);a?.icon&&(c=`url('https://cdn.discordapp.com/icons/${a.id}/${a.icon}.webp?size=32')`)}t.querySelector(".icon").setAttribute("style",c?`background-image: ${c};`:"background-color: #5865f2;")}function K(t){let e=t.querySelector(".unread"),c=t.getAttribute("data-pathname").split("/");if(c[1]==="channels"&&e){let a=d.ReadStateStore.getUnreadCount(c[3]);e.classList[a?"remove":"add"]("hidden"),e.textContent=a}}const W=q.default.interval(()=>{let t=document.querySelector(".tab-item.selected");if(t)t.querySelector(".title").textContent!==document.title&&T(t);else{let e=[...document.querySelectorAll(".tab-item")].pop();e?e.select():v(o.i18n.format("LOADING"),location.pathname,null,!0)}document.querySelectorAll(".tab-item, .bookmark-item").forEach(K),x()},100);{let t=d.UserStore.getCurrentUser().id;(o.persist.ghost.userTabs?.[t]||[{title:o.i18n.format("LOADING"),pathname:"/channels/@me",selected:!0}]).forEach(e=>{v(e.title,e.pathname,e.icon,e.selected)}),(o.persist.ghost.userBookmarks?.[t]||[]).forEach(e=>{$(e.title,e.pathname,e.icon)})}function O(t){if(!(t.ctrlKey&&t.shiftKey)||!t.code.startsWith("Digit"))return;let e=Math.max(Number(t.code.slice(5))-1,0),s=[...document.querySelectorAll(".tab-item")];s[e]&&!s[e].classList.contains("selected")&&s[e].select()}return window.addEventListener("keyup",O),()=>{window.removeEventListener("keyup",O),W(),n.remove()}})())},unload(){}};return H})(acord.dom,acord.utils,acord.ui,acord.patcher,acord.extension,acord.modules.common,acord.modules.common.React,acord.modules.webpack);
